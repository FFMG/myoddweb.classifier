using System;
using System.Windows.Forms;
using myoddweb.viewer.forms;
using Classifier.Interfaces;
using System.IO;
using System.Reflection;
using myoddweb.viewer.utils;

namespace myoddweb.viewer
{
  internal static class Program
  {
    /// <summary>
    /// Name for logging in the event viewer,
    /// </summary>
    private const string EventViewSource = "myoddweb.classifier";

    /// <summary>
    /// Initialise the engine and load all the resources neeed.
    /// Will load the database and so on to get the plugin ready for use.
    /// </summary>
    /// <param name="directoryName">string the directory we are loading from.</param>
    /// <param name="databasePath">string the name/path of the database we will be loading.</param>
    /// <param name="lastError">If needed, set the last error.</param>
    /// <returns></returns>
    private static IClassify1 InitialiseEngine(string directoryName, string databasePath, out string lastError )
    {
      lastError = "";
      var dllInteropPath = Path.Combine(directoryName, "x86\\Classifier.Interop.dll");
      var dllEnginePath = Path.Combine(directoryName, "x86\\Classifier.Engine.dll");
      if (Environment.Is64BitProcess)
      {
        dllInteropPath = Path.Combine(directoryName, "x64\\Classifier.Interop.dll");
        dllEnginePath = Path.Combine(directoryName, "x64\\Classifier.Engine.dll");
      }

      // look for the 
      Assembly asm;
      try
      {
        asm = Assembly.LoadFrom(dllInteropPath);
        if (null == asm)
        {
          lastError = $"Unable to load the interop file. '{dllInteropPath}'.";
          return null;
        }
      }
      catch (ArgumentException ex)
      {
        lastError = $"The interop file name/path does not appear to be valid. '{dllInteropPath}'.{Environment.NewLine}{Environment.NewLine}{ex.Message}";
        return null;
      }
      catch (FileNotFoundException ex)
      {
        lastError = $"Unable to load the interop file. '{dllInteropPath}'.{Environment.NewLine}{Environment.NewLine}{ex.Message}";
        return null;
      }

      // look for the interop interface
      var classifyEngine = TypeLoader.LoadTypeFromAssembly<IClassify1>(asm);
      if (null == classifyEngine)
      {
        // could not locate the interface.
        lastError = $"Unable to load the IClasify1 interface in the interop file. '{dllInteropPath}'.";
        return null;
      }

      if( !classifyEngine.Initialise(EventViewSource, dllEnginePath, databasePath))
      {
        return null;
      }

      // initialise the engine itself.
      return classifyEngine;
    }

    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
      Application.EnableVisualStyles();
      Application.SetCompatibleTextRenderingDefault(false);

      const string directoryName = @"H:\projects\c++\Classifier\Output\Debug\";
      const string databasePath = @"C:\Users\fguel\AppData\Roaming\myoddweb\Classifier\database.classifier";
      //const string databasePath = @"C:\Users\florentg\AppData\Roaming\MyOddWeb\Classifier\database.classifier";
      //const string directoryName = @"d:\projects\c++\Classifier\Output\Debug\";

      // the text
      // const string text = @"; ;Cheval.Ramnivaj@derivco.co.za;Cheval Ramnivaj;;Gap Cover;;<html xmlns:v=""urn:schemas-microsoft-com:vml"" xmlns:o=""urn:schemas-microsoft-com:office:office"" xmlns:w=""urn:schemas-microsoft-com:office:word"" xmlns:m=""http://schemas.microsoft.com/office/2004/12/omml"" xmlns=""http://www.w3.org/TR/REC-html40""><head> <meta name=""Generator"" content=""Microsoft Word 15 (filtered medium)""><style><!-- /* Font Definitions */ @font-face {font-family:""Cambria Math""; panose-1:2 4 5 3 5 4 6 3 2 4;} @font-face {font-family:""Calibri Light""; panose-1:2 15 3 2 2 2 4 3 2 4;} @font-face {font-family:Calibri; panose-1:2 15 5 2 2 2 4 3 2 4;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {margin:0cm; margin-bottom:.0001pt; font-size:11.0pt; font-family:""Calibri"",sans-serif; mso-fareast-language:EN-US;} a:link, span.MsoHyperlink {mso-style-priority:99; color:#0563C1; text-decoration:underline;} a:visited, span.MsoHyperlinkFollowed {mso-style-priority:99; color:#954F72; text-decoration:underline;} span.EmailStyle17 {mso-style-type:personal-compose; font-family:""Calibri Light"",sans-serif; color:windowtext;} .MsoChpDefault {mso-style-type:export-only; font-family:""Calibri"",sans-serif; mso-fareast-language:EN-US;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt;} div.WordSection1 {page:WordSection1;} --></style><!--[if gte mso 9]><xml> <o:shapedefaults v:ext=""edit"" spidmax=""1026"" /> </xml><![endif]--><!--[if gte mso 9]><xml> <o:shapelayout v:ext=""edit""> <o:idmap v:ext=""edit"" data=""1"" /> </o:shapelayout></xml><![endif]--></head><body lang=""EN-ZA"" link=""#0563C1"" vlink=""#954F72""><div class=""WordSection1""><p class=""MsoNormal""><span style=""font-family:&quot;Calibri Light&quot;,sans-serif"">Hi, <o:p></o:p></span></p><p class=""MsoNormal""><span style=""font-family:&quot;Calibri Light&quot;,sans-serif""><o:p>&nbsp;</o:p></span></p><p class=""MsoNormal""><span style=""font-family:&quot;Calibri Light&quot;,sans-serif"">I am looking for recommendations for Gap Cover for my parents. They are current with Sirago – just looking for something that’s more reasonable priced for them.<o:p></o:p></span></p><p class=""MsoNormal""><span style=""font-family:&quot;Calibri Light&quot;,sans-serif""><o:p>&nbsp;</o:p></span></p><p class=""MsoNormal""><span style=""font-family:&quot;Calibri Light&quot;,sans-serif;mso-fareast-language:EN-ZA"">Regards<o:p></o:p></span></p><p class=""MsoNormal""><span style=""font-family:&quot;Calibri Light&quot;,sans-serif;mso-fareast-language:EN-ZA"">Cheval<o:p></o:p></span></p><p class=""MsoNormal""><o:p>&nbsp;</o:p></p></div></body></html>";
      // const string text = @";Yushir Maharaj; Florent Guelfucci; Michelle Funcke; Lance Dempster; Kirsty Corbett; Richard Proudfoot; IT Gaming Services - IOM;Andrew.Ramsden@derivco.co.za;Andrew Ramsden;Kureshan Pather; Wayne Slabbert; Neil Sukran;RE: Mega Moolah Investigation;Yushir.Maharaj@derivco.co.za Florent.Guelfucci@derivco.co.za Michelle.Funcke@derivco.co.za Lance.Dempster@derivco.co.za Kirsty.Corbett@derivco.co.za Richard.Proudfoot@derivco.co.im ITGamingServicesIOM@derivco.com Kureshan.Pather@derivco.co.za Wayne.Slabbert@derivco.co.za Neil.Sukran@derivco.co.za;<html xmlns:v=""urn:schemas-microsoft-com:vml"" xmlns:o=""urn:schemas-microsoft-com:office:office"" xmlns:w=""urn:schemas-microsoft-com:office:word"" xmlns:m=""http://schemas.microsoft.com/office/2004/12/omml"" xmlns=""http://www.w3.org/TR/REC-html40""><head><meta name=Generator content=""Microsoft Word 15 (filtered medium)""><!--[if !mso]><style>v\:* {behavior:url(#default#VML);} o\:* {behavior:url(#default#VML);} w\:* {behavior:url(#default#VML);} .shape {behavior:url(#default#VML);} </style><![endif]--><style><!-- /* Font Definitions */ @font-face {font-family:Wingdings; panose-1:5 0 0 0 0 0 0 0 0 0;} @font-face {font-family:""Cambria Math""; panose-1:2 4 5 3 5 4 6 3 2 4;} @font-face {font-family:Calibri; panose-1:2 15 5 2 2 2 4 3 2 4;} @font-face {font-family:Tahoma; panose-1:2 11 6 4 3 5 4 4 2 4;} @font-face {font-family:""Avenir Medium"";} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {margin:0in; margin-bottom:.0001pt; font-size:11.0pt; font-family:""Calibri"",""sans-serif"";} a:link, span.MsoHyperlink {mso-style-priority:99; color:#0563C1; text-decoration:underline;} a:visited, span.MsoHyperlinkFollowed {mso-style-priority:99; color:#954F72; text-decoration:underline;} p.MsoAcetate, li.MsoAcetate, div.MsoAcetate {mso-style-priority:99; mso-style-link:""Balloon Text Char""; margin:0in; margin-bottom:.0001pt; font-size:8.0pt; font-family:""Tahoma"",""sans-serif"";} p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph {mso-style-priority:34; margin-top:0in; margin-right:0in; margin-bottom:0in; margin-left:.5in; margin-bottom:.0001pt; font-size:11.0pt; font-family:""Calibri"",""sans-serif"";} span.BalloonTextChar {mso-style-name:""Balloon Text Char""; mso-style-priority:99; mso-style-link:""Balloon Text""; font-family:""Tahoma"",""sans-serif"";} span.EmailStyle20 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:windowtext;} span.EmailStyle21 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle22 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:windowtext;} span.EmailStyle23 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle24 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle25 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle26 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle27 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle28 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle29 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle30 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle31 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle32 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle33 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle34 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle35 {mso-style-type:personal; font-family:""Calibri"",""sans-serif""; color:#1F497D;} span.EmailStyle36 {mso-style-type:personal-reply; font-family:""Calibri"",""sans-serif""; color:#1F497D;} .MsoChpDefault {mso-style-type:export-only; font-size:10.0pt;} @page WordSection1 {size:8.5in 11.0in; margin:1.0in 1.0in 1.0in 1.0in;} div.WordSection1 {page:WordSection1;} --></style><!--[if gte mso 9]><xml> <o:shapedefaults v:ext=""edit"" spidmax=""1026"" /> </xml><![endif]--><!--[if gte mso 9]><xml> <o:shapelayout v:ext=""edit""> <o:idmap v:ext=""edit"" data=""1"" /> </o:shapelayout></xml><![endif]--></head><body lang=EN-US link=""#0563C1"" vlink=""#954F72""><div class=WordSection1><p class=MsoNormal><span style='color:#1F497D'>Hey Yushir,<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks for the update.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Just double checking, by error do you mean there were no WinRejections? (You would see this in the perf counters and or metrics)<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>How often are players winning the Jackpot in your simulations?<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks,<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Andrew<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Yushir Maharaj <br><b>Sent:</b> Monday, October 31, 2016 9:05 AM<br><b>To:</b> Florent Guelfucci; Michelle Funcke; Andrew Ramsden; Lance Dempster; Kirsty Corbett; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Wayne Slabbert; Neil Sukran; Yushir Maharaj<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Hi Everyone,<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>A quick update on the below.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>We have run the scenario below (restarting Veyron 6 and 7 with Legacy Progressive Tag) over the weekend and the error did not occur.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>There are also no errors in the logs for the test running on the LNP environment.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>We will keep running the tests and send through an update if there are any new developments.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Kind Regards,<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><img width=624 height=131 id=""_x0000_i1025"" src=""cid:image001.png@01D23356.19C4FD30"" alt=EmailSig-Performance><a name=""_MailEndCompose""></a><o:p></o:p></span></p><div><div style='border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b><span style='font-size:10.0pt;font-family:""Tahoma"",""sans-serif""'>From:</span></b><span style='font-size:10.0pt;font-family:""Tahoma"",""sans-serif""'> Florent Guelfucci <br><b>Sent:</b> Friday, October 28, 2016 3:53 PM<br><b>To:</b> Michelle Funcke; Andrew Ramsden; Lance Dempster; Yushir Maharaj; Kirsty Corbett; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Wayne Slabbert; Neil Sukran<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></span></p></div></div><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>F.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Michelle Funcke <br><b>Sent:</b> Friday, October 28, 2016 3:40 PM<br><b>To:</b> Andrew Ramsden &lt;<a href=""mailto:Andrew.Ramsden@derivco.co.za"">Andrew.Ramsden@derivco.co.za</a>&gt;; Lance Dempster &lt;<a href=""mailto:Lance.Dempster@derivco.co.za"">Lance.Dempster@derivco.co.za</a>&gt;; Yushir Maharaj &lt;<a href=""mailto:Yushir.Maharaj@derivco.co.za"">Yushir.Maharaj@derivco.co.za</a>&gt;; Kirsty Corbett &lt;<a href=""mailto:Kirsty.Corbett@derivco.co.za"">Kirsty.Corbett@derivco.co.za</a>&gt;; Richard Proudfoot &lt;<a href=""mailto:Richard.Proudfoot@derivco.co.im"">Richard.Proudfoot@derivco.co.im</a>&gt;; IT Gaming Services - IOM &lt;<a href=""mailto:ITGamingServicesIOM@derivco.com"">ITGamingServicesIOM@derivco.com</a>&gt;<br><b>Cc:</b> Kureshan Pather &lt;<a href=""mailto:Kureshan.Pather@derivco.co.za"">Kureshan.Pather@derivco.co.za</a>&gt;; Wayne Slabbert &lt;<a href=""mailto:Wayne.Slabbert@derivco.co.za"">Wayne.Slabbert@derivco.co.za</a>&gt;; Florent Guelfucci &lt;<a href=""mailto:Florent.Guelfucci@derivco.co.za"">Florent.Guelfucci@derivco.co.za</a>&gt;; Neil Sukran &lt;<a href=""mailto:Neil.Sukran@derivco.co.za"">Neil.Sukran@derivco.co.za</a>&gt;<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span style='color:#1F497D'>Hey Andrew,<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>We started two instances (Veyron 6 and 7) with the LegacyProgressive tag. They loaded all the non CEP progressive games with no errors.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>We will periodically restart these two services over the weekend and send you any errors in the log files when they arise.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Michelle<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Andrew Ramsden <br><b>Sent:</b> Friday, October 28, 2016 2:36 PM<br><b>To:</b> Lance Dempster; Yushir Maharaj; Kirsty Corbett; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Michelle Funcke; Wayne Slabbert; Florent Guelfucci; Neil Sukran<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span style='color:#1F497D'>Thank you Yushir.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>We have noticed that there is still a Veyron service somewhere (we are working with IT to track it down) that is playing using the legacy progressive protocols. It looks like the issue might start happening after an influx of legacy initialisation requests (this happens when the VeyronHost starts up).<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Would it be possible to make one of the Veyron instances version 6 with the betaVeyron useLegacyProgressive=&#8221;true&#8221; please?<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>With this version, please ensure that you have all progressive games loaded in the host(s). The idea here is that we are trying to get as many initialisation requests as possible.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Every now and again, please give the &#8220;legacy&#8221; Veyron a restart to force initialisation requests.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>I&#8217;m hoping that by doing this with the load that you currently have going, that things will go south.<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks,<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Andrew<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Lance Dempster <br><b>Sent:</b> Friday, October 28, 2016 10:55 AM<br><b>To:</b> Yushir Maharaj; Kirsty Corbett; Andrew Ramsden; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Michelle Funcke; Wayne Slabbert; Florent Guelfucci; Neil Sukran<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span style='color:#1F497D'>Thank you for the update<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Yushir Maharaj <br><b>Sent:</b> Friday, October 28, 2016 9:48 AM<br><b>To:</b> Kirsty Corbett; Lance Dempster; Andrew Ramsden; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Michelle Funcke; Wayne Slabbert; Florent Guelfucci; Neil Sukran; Yushir Maharaj<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Hi Everyone,<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Just an update on the below.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>All 3 of our tests are still running. There are no errors in the logs and the service has not crashed.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>We will update again if there are any new developments.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Kind Regards,<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><img border=0 width=624 height=131 id=""_x0000_i1026"" src=""cid:image001.png@01D23356.19C4FD30"" alt=EmailSig-Performance><o:p></o:p></span></p><div><div style='border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b><span style='font-size:10.0pt;font-family:""Tahoma"",""sans-serif""'>From:</span></b><span style='font-size:10.0pt;font-family:""Tahoma"",""sans-serif""'> Yushir Maharaj <br><b>Sent:</b> Thursday, October 27, 2016 9:23 AM<br><b>To:</b> Kirsty Corbett; Lance Dempster; Andrew Ramsden; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Michelle Funcke; Wayne Slabbert; Florent Guelfucci; Neil Sukran; Yushir Maharaj<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></span></p></div></div><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Hi Andrew,<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>We found errors generated in the MGS_VeyronHost_x64_IslandParadise_5000_APS logs in one of our tests. This only happened on the LNP environment and not on the Payout environments.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>The errors were as follows:<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><i><span lang=EN-ZA style='color:#1F497D'>Error 2: Request failed: Severity 14, Number 2627 - System.Data.SqlClient.SqlException (0x80131904): Violation of PRIMARY KEY constraint 'PK_ProgressiveAPSBetSummary'. Cannot insert duplicate key in object 'dbo.tb_ProgressiveAPSBetSummary'. The duplicate key value is (17501, 5001, 0, 26, 625).<o:p></o:p></span></i></p><p class=MsoNormal style='margin-left:.5in'><i><span lang=EN-ZA style='color:#1F497D'>Error inserting into tb_ProgressiveAPSBetSummary in sp_ProgressiveAPSLogBetStats<o:p></o:p></span></i></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Please can you have a look at the attached logs and advise if these errors are related to the </span><span lang=EN-ZA><a href=""http://canvas.mgsops.net/queues/#/dashboard/0/0/INC733119/incident"">incident</a><span style='color:#1F497D'> that was logged, as they appear to be similar.<o:p></o:p></span></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Kind Regards,<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><img border=0 width=624 height=131 id=""_x0000_i1027"" src=""cid:image001.png@01D23356.19C4FD30"" alt=EmailSig-Performance><o:p></o:p></span></p><div><div style='border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b><span style='font-size:10.0pt;font-family:""Tahoma"",""sans-serif""'>From:</span></b><span style='font-size:10.0pt;font-family:""Tahoma"",""sans-serif""'> Kirsty Corbett <br><b>Sent:</b> Wednesday, October 26, 2016 4:01 PM<br><b>To:</b> Lance Dempster; Andrew Ramsden; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Yushir Maharaj; Michelle Funcke; Wayne Slabbert; Florent Guelfucci; Neil Sukran<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></span></p></div></div><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Hi Everyone<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Based on the discussion with Lance and Andrew we have added a third environment and testing strategy.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>This testing strategy consists of:<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>60 Players<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>10 Playing to British Pound<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>10 Playing to Euro<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>10 Playing to Australian Dollar<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>10 Playing to Hong Kong Dollar<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>10 Playing to Thai Baht <o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>10 Playing to Japanese Yen<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>5 second delay per spin<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>Using Max Strategy<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>2 Veyron Hosts running &#8211; playing to Mega Moolah<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>APS Config Changes:<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>&lt;add key=&quot;maxWorkers&quot; value=&quot;2&quot;/&gt; changed from &lt;add key=&quot;maxWorkers&quot; value=&quot;8&quot;/&gt;<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Jackpot Values have been made the following on all environments:<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Mega = 10000000.00<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Major = 10000.00<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Minor = 100.00<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Mini = 10.00<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Regards<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><img border=0 width=624 height=131 id=""_x0000_i1028"" src=""cid:image002.png@01D23356.19C4FD30"" alt=""Kirsty - LnP""><o:p></o:p></span></p></div><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Lance Dempster <br><b>Sent:</b> 26 October 2016 02:35 PM<br><b>To:</b> Kirsty Corbett &lt;<a href=""mailto:Kirsty.Corbett@derivco.co.za"">Kirsty.Corbett@derivco.co.za</a>&gt;; Andrew Ramsden &lt;<a href=""mailto:Andrew.Ramsden@derivco.co.za"">Andrew.Ramsden@derivco.co.za</a>&gt;; Richard Proudfoot &lt;<a href=""mailto:Richard.Proudfoot@derivco.co.im"">Richard.Proudfoot@derivco.co.im</a>&gt;; IT Gaming Services - IOM &lt;<a href=""mailto:ITGamingServicesIOM@derivco.com"">ITGamingServicesIOM@derivco.com</a>&gt;<br><b>Cc:</b> Kureshan Pather &lt;<a href=""mailto:Kureshan.Pather@derivco.co.za"">Kureshan.Pather@derivco.co.za</a>&gt;; Yushir Maharaj &lt;<a href=""mailto:Yushir.Maharaj@derivco.co.za"">Yushir.Maharaj@derivco.co.za</a>&gt;; Michelle Funcke &lt;<a href=""mailto:Michelle.Funcke@derivco.co.za"">Michelle.Funcke@derivco.co.za</a>&gt;; Wayne Slabbert &lt;<a href=""mailto:Wayne.Slabbert@derivco.co.za"">Wayne.Slabbert@derivco.co.za</a>&gt;; Florent Guelfucci &lt;<a href=""mailto:Florent.Guelfucci@derivco.co.za"">Florent.Guelfucci@derivco.co.za</a>&gt;; Neil Sukran &lt;<a href=""mailto:Neil.Sukran@derivco.co.za"">Neil.Sukran@derivco.co.za</a>&gt;<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Hi Kirsty<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Please could you add in some weaker currencies and increase the jackpot to 10 million (please add the two zero&#8217;s for cents)<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks,<br>Lance<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Kirsty Corbett <br><b>Sent:</b> Wednesday, October 26, 2016 2:15 PM<br><b>To:</b> Andrew Ramsden; Richard Proudfoot; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Yushir Maharaj; Michelle Funcke; Wayne Slabbert; Lance Dempster; Florent Guelfucci; Neil Sukran<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Readding Neil<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><img border=0 width=624 height=131 id=""_x0000_i1029"" src=""cid:image002.png@01D23356.19C4FD30"" alt=""Kirsty - LnP""><o:p></o:p></span></p></div><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Andrew Ramsden <br><b>Sent:</b> 26 October 2016 01:47 PM<br><b>To:</b> Kirsty Corbett &lt;<a href=""mailto:Kirsty.Corbett@derivco.co.za"">Kirsty.Corbett@derivco.co.za</a>&gt;; Richard Proudfoot &lt;<a href=""mailto:Richard.Proudfoot@derivco.co.im"">Richard.Proudfoot@derivco.co.im</a>&gt;; IT Gaming Services - IOM &lt;<a href=""mailto:ITGamingServicesIOM@derivco.com"">ITGamingServicesIOM@derivco.com</a>&gt;<br><b>Cc:</b> Kureshan Pather &lt;<a href=""mailto:Kureshan.Pather@derivco.co.za"">Kureshan.Pather@derivco.co.za</a>&gt;; Yushir Maharaj &lt;<a href=""mailto:Yushir.Maharaj@derivco.co.za"">Yushir.Maharaj@derivco.co.za</a>&gt;; Michelle Funcke &lt;<a href=""mailto:Michelle.Funcke@derivco.co.za"">Michelle.Funcke@derivco.co.za</a>&gt;; Wayne Slabbert &lt;<a href=""mailto:Wayne.Slabbert@derivco.co.za"">Wayne.Slabbert@derivco.co.za</a>&gt;; Lance Dempster &lt;<a href=""mailto:Lance.Dempster@derivco.co.za"">Lance.Dempster@derivco.co.za</a>&gt;; Florent Guelfucci &lt;<a href=""mailto:Florent.Guelfucci@derivco.co.za"">Florent.Guelfucci@derivco.co.za</a>&gt;<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks Kirsty and Richard </span><span style='font-family:Wingdings;color:#1F497D'>J</span><span style='color:#1F497D'><o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Kirsty Corbett <br><b>Sent:</b> Wednesday, October 26, 2016 1:45 PM<br><b>To:</b> Richard Proudfoot; Andrew Ramsden; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Yushir Maharaj; Michelle Funcke; Wayne Slabbert; Lance Dempster; Florent Guelfucci<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Hi All<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>@Richard: Thanks so much for the accompanying information.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>The Soak test we were running has been stopped and replaced with the following strategy on both environments:<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>60 Players<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>20 Playing to British Pound<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>20 Playing to Euro<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:""Courier New"";color:#1F497D'>o</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>20 Playing to Australian Dollar <o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>5 second delay per spin<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:#1F497D'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:#1F497D'>Using Max Strategy<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>We have also logged a call to Blue Mesa to update the RaptorGS1 specs to be similar to those found live.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal style='text-indent:.5in'><i><span lang=EN-ZA style='color:#1F497D'>The New Testing Approach &nbsp;was created from the information sent where the following key points were noted:<o:p></o:p></span></i></p><p class=MsoNormal style='margin-left:.5in;text-indent:.5in'><i><span lang=EN-ZA style='color:#1F497D'>The Three currencies that were used:<o:p></o:p></span></i></p><p class=MsoNormal style='margin-left:1.0in;text-indent:.5in'><i><span lang=EN-ZA style='color:#1F497D'>British Pound &#8211; CurrencyID 9<o:p></o:p></span></i></p><p class=MsoNormal style='margin-left:1.0in;text-indent:.5in'><i><span lang=EN-ZA style='color:#1F497D'>Euro &#8211; CurrencyID 26<o:p></o:p></span></i></p><p class=MsoNormal style='margin-left:1.0in;text-indent:.5in'><i><span lang=EN-ZA style='color:#1F497D'>Australian Dollar &#8211; CurrencyID 5<o:p></o:p></span></i></p><p class=MsoNormal><i><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></i></p><p class=MsoNormal style='margin-left:.5in'><i><span lang=EN-ZA style='color:#1F497D'>Max Number of bets per hour: 3422<o:p></o:p></span></i></p><p class=MsoNormal style='text-indent:.5in'><i><span lang=EN-ZA style='color:#1F497D'>**This means that ~0.95bets per second occur<o:p></o:p></span></i></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Our strategy should achieve a maximum of 12 Bets Per Second &#8211; which is a realistic load which simulates the &#8220;environment&#8221; where the issue occurred.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'>Regards<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><img border=0 width=624 height=131 id=""_x0000_i1030"" src=""cid:image003.png@01D23356.19C4FD30"" alt=""Kirsty - LnP""><o:p></o:p></span></p></div><p class=MsoNormal><span lang=EN-ZA style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Richard Proudfoot <br><b>Sent:</b> 26 October 2016 01:12 PM<br><b>To:</b> Andrew Ramsden &lt;<a href=""mailto:Andrew.Ramsden@derivco.co.za"">Andrew.Ramsden@derivco.co.za</a>&gt;; Kirsty Corbett &lt;<a href=""mailto:Kirsty.Corbett@derivco.co.za"">Kirsty.Corbett@derivco.co.za</a>&gt;; IT Gaming Services - IOM &lt;<a href=""mailto:ITGamingServicesIOM@derivco.com"">ITGamingServicesIOM@derivco.com</a>&gt;<br><b>Cc:</b> Kureshan Pather &lt;<a href=""mailto:Kureshan.Pather@derivco.co.za"">Kureshan.Pather@derivco.co.za</a>&gt;; Yushir Maharaj &lt;<a href=""mailto:Yushir.Maharaj@derivco.co.za"">Yushir.Maharaj@derivco.co.za</a>&gt;; Michelle Funcke &lt;<a href=""mailto:Michelle.Funcke@derivco.co.za"">Michelle.Funcke@derivco.co.za</a>&gt;; Wayne Slabbert &lt;<a href=""mailto:Wayne.Slabbert@derivco.co.za"">Wayne.Slabbert@derivco.co.za</a>&gt;; Lance Dempster &lt;<a href=""mailto:Lance.Dempster@derivco.co.za"">Lance.Dempster@derivco.co.za</a>&gt;; Florent Guelfucci &lt;<a href=""mailto:Florent.Guelfucci@derivco.co.za"">Florent.Guelfucci@derivco.co.za</a>&gt;<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA>Hey Guys,<o:p></o:p></span></p><p class=MsoListParagraph><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>1.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>On Average how many players are connected and playing the game when the APS falls over?<o:p></o:p></span></p><p class=MsoListParagraph><span lang=EN-ZA style='color:red'>See attached spreadsheet for bets per hour for Mega Moolah<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>2.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Are they playing to any specific currency when this happens? Or what are the most common currencies being used during gameplay.<o:p></o:p></span></p><p class=MsoListParagraph><span lang=EN-ZA style='color:red'>See attached spreadsheet for bets per hour broken down by currency for Mega Moolah<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>3.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>What version of the Veyron Host is being used?<o:p></o:p></span></p><p class=MsoListParagraph><span lang=EN-ZA style='color:red'>7.0.4.17388<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>4.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>What is the version of the Progressive APS is being used?<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>2.0.7.16240<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>5.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Any idea on the average throughput when the APS fell over &#8211; to help scaling.<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>Hopefully the attached XLS and below graphs will be able to help with this q?<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>6.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Any specific counters/logs you want us to monitor or just the standard counters/logs?<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>Andy has changed alerts to monitor for the events we are seeing when the symptoms occur.</span><span lang=EN-ZA><o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>7.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>What is the Specification/Architecture of the Live Progressive APS box?<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>MAL1204<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>CPU: 8 Socket (Single Cores) @ 2.80GHz<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>RAM: 32GB<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>HDD: C:\ 60GB, M:\ 80GB<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'>OS: Windows Server 2012 R2 (x64)<o:p></o:p></span></p><p class=MsoNormal style='margin-left:.5in'><span lang=EN-ZA style='color:red'><o:p>&nbsp;</o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>8.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Are there any &#8220;signs&#8221; that once &#8220;so and so&#8221; happens the APS falls over?<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:red'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:red'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:red'>We see spamming of &#8220;2016-10-25 23:40:22 [71] Warning 4: Maximum number of workers reached: 50. Throttling input...&#8221; in the MGS_ProgressiveAPS logs<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:red'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:red'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:red'>Accompanied by &#8220;2016-10-25 23:39:28 [40] Information 0: Service not available (Service Type = 80)&#8221; in the MGS_Router logs on the APS Gameplay Router<o:p></o:p></span></p><p class=MsoListParagraph style='margin-left:1.0in;text-indent:-.25in'><span lang=EN-ZA style='font-family:Symbol;color:red'>&middot;</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif"";color:red'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA style='color:red'>On the graphs below we see anomalies between 18:00 GMT and 02:00GMT (note that we don&#8217;t see any impact to Successful APS Events?) - <a href=""http://grafana.mgsops.net/dashboard/db/it-gaming-services-operators"">http://grafana.mgsops.net/dashboard/db/it-gaming-services-operators</a><o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:red'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-GB><img border=0 width=1732 height=266 id=""Picture_x0020_5"" src=""cid:image004.png@01D23356.19C4FD30""></span><span lang=EN-ZA style='color:red'><o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:red'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-GB><img border=0 width=956 height=789 id=""Picture_x0020_6"" src=""cid:image005.png@01D23356.19C4FD30""></span><span lang=EN-ZA style='color:red'><o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA style='color:red'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA>Cheers<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA>Rich<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-GB style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-GB style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><p class=MsoNormal><span lang=EN-GB style='color:#1F497D'><img border=0 width=296 height=57 id=""Picture_x0020_42"" src=""cid:image006.gif@01D23356.19C4FD30"" alt=Derivco></span><span lang=EN-ZA style='color:#1F497D'><o:p></o:p></span></p><p class=MsoNormal><b><span lang=EN-ZA style='font-size:10.0pt;color:#262626'>Richard Proudfoot<o:p></o:p></span></b></p><p class=MsoNormal><span lang=EN-ZA style='font-size:10.0pt;color:#595959'>IT Gaming Services Engineer<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-GB style='font-size:9.0pt;font-family:""Avenir Medium"";color:#595959'><img border=0 width=291 height=7 id=""Picture_x0020_43"" src=""cid:image007.gif@01D23356.19C4FD30"" alt=""line_2""></span><span lang=EN-ZA style='font-size:9.0pt;font-family:""Avenir Medium"";color:#1F497D'><o:p></o:p></span></p><p class=MsoNormal><span lang=EN-GB style='font-size:10.0pt;color:#595959'><img border=0 width=16 height=11 id=""Picture_x0020_46"" src=""cid:image008.gif@01D23356.19C4FD30"" alt=email></span><span lang=EN-ZA style='font-size:10.0pt;color:#595959'>&nbsp;&nbsp;</span><span lang=EN-ZA style='font-size:9.0pt;color:#1F497D'><a href=""mailto:richard.proudfoot@derivco.co.im"">richard.proudfoot@derivco.co.im</a></span><u><span lang=EN-GB style='color:#0563C1'><o:p></o:p></span></u></p><p class=MsoNormal><span lang=EN-GB><a href=""http://""><span style='color:#4BACC6;text-decoration:none'><img border=0 width=13 height=12 id=""Picture_x0020_47"" src=""cid:image009.gif@01D23356.19C4FD30"" alt=Web></span></a></span><span lang=EN-ZA style='color:#4BACC6'>&nbsp;&nbsp; </span><span lang=EN-GB style='color:#1F497D'><a href=""http://www.derivco.co.im/""><span lang=EN-ZA style='font-size:9.0pt'>www.derivco.co.im</span></a></span><span lang=EN-GB style='font-size:9.0pt;color:#1F497D'> </span><span lang=EN-ZA style='color:#1F497D'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang=EN-ZA style='color:#4BACC6'>&nbsp;&nbsp;&nbsp;</span><span lang=EN-ZA style='color:#595959'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang=EN-GB style='color:#1F497D'><o:p></o:p></span></p></div><p class=MsoNormal><span lang=EN-GB style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Andrew Ramsden <br><b>Sent:</b> 26 October 2016 10:31<br><b>To:</b> Kirsty Corbett; IT Gaming Services - IOM<br><b>Cc:</b> Kureshan Pather; Yushir Maharaj; Michelle Funcke; Wayne Slabbert; Lance Dempster; Florent Guelfucci<br><b>Subject:</b> RE: Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><span lang=EN-GB><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Good morning Kirsty,<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Sorry&#8230; I&#8217;ve been in meetings this morning (relating to this issue :/)<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>I can give you some of this info, however for most of the info, I&#8217;ll just be a proxy, so I&#8217;ve included IT in on this, to answer what they can </span><span style='font-family:Wingdings;color:#1F497D'>J</span><span style='color:#1F497D'><o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><b><span style='color:#1F497D'>@IT Gaming Services</span></b><span style='color:#1F497D'> &#8211; Please can you answer the questions below, to help Testing to try and replicate this issue?<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Thanks,<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'>Andrew<o:p></o:p></span></p><p class=MsoNormal><span style='color:#1F497D'><o:p>&nbsp;</o:p></span></p><div><div style='border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in'><p class=MsoNormal><b>From:</b> Kirsty Corbett <br><b>Sent:</b> Wednesday, October 26, 2016 9:30 AM<br><b>To:</b> Andrew Ramsden<br><b>Cc:</b> Kureshan Pather; Yushir Maharaj; Michelle Funcke; Wayne Slabbert; Lance Dempster<br><b>Subject:</b> Mega Moolah Investigation<o:p></o:p></p></div></div><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><span lang=EN-ZA>Good Morning Andrew<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA>Please can you send us any live information you can gather for the Mega Moolah problem, also please can you help us answer the following questions which should help us define and set up our testing strategy.<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>1.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>On Average how many players are connected and playing the game when the APS falls over?<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>2.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Are they playing to any specific currency when this happens? Or what are the most common currencies being used during gameplay.<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>3.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>What version of the Veyron Host is being used?<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>4.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>What is the version of the Progressive APS is being used?<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>5.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Any idea on the average throughput when the APS fell over &#8211; to help scaling.<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>6.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Any specific counters/logs you want us to monitor or just the standard counters/logs?<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>7.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>What is the Specification/Architecture of the Live Progressive APS box?<o:p></o:p></span></p><p class=MsoListParagraph style='text-indent:-.25in'><span lang=EN-ZA>8.</span><span lang=EN-ZA style='font-size:7.0pt;font-family:""Times New Roman"",""serif""'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang=EN-ZA>Are there any &#8220;signs&#8221; that once &#8220;so and so&#8221; happens the APS falls over?<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span lang=EN-ZA>Regards<o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><img border=0 width=624 height=131 id=""Picture_x0020_1"" src=""cid:image002.png@01D23356.19C4FD30"" alt=""Kirsty - LnP""><span lang=EN-ZA><o:p></o:p></span></p><p class=MsoNormal><span lang=EN-ZA><o:p>&nbsp;</o:p></span></p></div></body></html>";
      const string text = "This is a very small test";

      // var text = "Hello World";

      string lastError;
      var engine = InitialiseEngine(directoryName, databasePath, out lastError);
      Application.Run(new DetailsForm( engine, text ));

      // release it then.
      engine?.Release();
    }
  }
}
